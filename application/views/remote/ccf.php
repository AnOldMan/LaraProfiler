<?php


// DO NOT USE repeat OR offset UNLESS YOU KNOW WHAT YOU'RE DOING
function CCFtoGC( $sCommand, $nModule = 2, $nHertz = 40000, $nId = 1, $nRepeat = 3, $nOffset = 1 )
{
	// CHECK CCF CODE FOR ERRORS
	if( substr( $sCommand, 0, 4 ) != '0000' ) return "Invalid CCF: RAW starts with 0000";

	$aExplode  = explode( ' ', $sCommand, 264 );
	$nCount = count( $aExplode );

	if( $nCount < 8 ) return "Invalid CCF: less than 8 elements OR missing spaces";
	if( $nCount > 260 ) return "Invalid CCF: more than 260 elements";

	$aSplit = str_split( $sCommand );
	foreach( $aSplit as $k => $a ) if ( !preg_match( "/[A-Fa-f0-9 ]/", $a ) ) return "Invalid CCF: non hexadecimal";

	$sPairs1 = 2*( hexdec( $aExplode[2] ) );
	$sPairs2 = 2*( hexdec( $aExplode[3] ) );
	if( $aExplode[2] == '0000' ) { if( $sPairs2 != $nCount - 4 ) return "Invalid CCF: bad pair count: single"; }
	elseif( $aExplode[3] == '0000' ) { if( $sPairs1 != $nCount - 4 ) return "Invalid CCF: bad pair count: repeating"; }
	elseif( $sPairs1 + $sPairs2 != $nCount - 4 ) return "Invalid CCF: bad pair count: mulitple";

	$nHertz = (int)( ( 41450 / hexdec( $aExplode[1] ) + 5 ) / 10 ) * 1000;
	if( $nHertz < 20000 || $nHertz > 500000 ) return "Invalid CCF: frequency out of range";
	// PASSED ERROR CHECK

	// USED TO VERIFY OUR sendir IS RESPONDED TO
	$nUID = rand( 1000, 9999 );

	// WE DON'T SEND FIRST FOUR ELEMENTS
	unset( $aExplode[0] ); unset( $aExplode[1] ); unset( $aExplode[2] ); unset( $aExplode[3] );
	
	//sendir,<mod-addr>:<conn-addr>,<uniqueID>,<frequency>,<repeatcount>,<offset>,<command_string>
	$sSendir = "sendir,$nModule:$nId,$nUID,$nHertz,$nRepeat,$nOffset";
	foreach ( $aExplode as $k => $a ) $sSendir .= "," . hexdec( $a );

	return $sSendir;
}



$aCcf = array(
"Number1"  => "0000 0067 0000 0015 0060 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Number2"  => "0000 0067 0000 0015 0060 0018 0030 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Number3"  => "0000 0067 0000 0015 0060 0018 0018 0018 0030 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Number4"  => "0000 0067 0000 0015 0060 0018 0030 0018 0030 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Number5"  => "0000 0067 0000 0015 0060 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Number6"  => "0000 0067 0000 0015 0060 0018 0030 0018 0018 0018 0030 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Number7"  => "0000 0067 0000 0015 0060 0018 0018 0018 0030 0018 0030 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Number8"  => "0000 0067 0000 0015 0060 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Number9"  => "0000 0067 0000 0015 0060 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Number0"  => "0000 0067 0000 0015 0060 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Enter"    => "0000 0067 0000 0015 0060 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Return"   => "0000 0067 0000 0015 0060 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Clear"    => "0000 0067 0000 0015 0060 0018 0030 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Open"     => "0000 0067 0000 0015 0060 0018 0018 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Menu"     => "0000 0067 0000 0015 0060 0018 0030 0018 0030 0018 0018 0018 0030 0018 0030 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Program"  => "0000 0067 0000 0015 0060 0018 0030 0018 0030 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Repeat"   => "0000 0067 0000 0015 0060 0018 0018 0018 0018 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"PowerOn"  => "0000 0067 0000 0015 0060 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"PowerOff" => "0000 0067 0000 0015 0060 0018 0030 0018 0030 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Prev"     => "0000 0067 0000 0015 0060 0018 0018 0018 0018 0018 0018 0018 0018 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Next"     => "0000 0067 0000 0015 0060 0018 0030 0018 0018 0018 0018 0018 0018 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Play"     => "0000 0067 0000 0015 0060 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Shuffle"  => "0000 0067 0000 0015 0060 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",//																																																																									  0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6
"Stop"     => "0000 0067 0000 0015 0060 0018 0018 0018 0018 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Pause"    => "0000 0067 0000 0015 0060 0018 0030 0018 0018 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Minus"    => "0000 0067 0000 0015 0060 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0018 0018 0018 0018 0030 0018 0030 0018 0018 03F6",
"Plus"     => "0000 0067 0000 0015 0060 0018 0018 0018 0030 0018 0030 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0018 0018 0018 0018 0030 0018 0030 0018 0018 03F6",
"Flip"     => "0000 0067 0000 0015 0060 0018 0030 0018 0030 0018 0030 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0018 0018 0018 0018 0030 0018 0030 0018 0018 03F6",
"Folder"   => "0000 0067 0000 0015 0060 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0018 0018 0018 0018 0030 0018 0030 0018 0018 03F6",
"Easyplay" => "0000 0067 0000 0015 0060 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Display"  => "0000 0067 0000 0015 0060 0018 0018 0018 0018 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Subtitle" => "0000 0067 0000 0015 0060 0018 0030 0018 0030 0018 0018 0018 0018 0018 0018 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Audio"    => "0000 0067 0000 0015 0060 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Angle"    => "0000 0067 0000 0015 0060 0018 0030 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Up"       => "0000 0067 0000 0015 0060 0018 0030 0018 0018 0018 0018 0018 0030 0018 0030 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Down"     => "0000 0067 0000 0015 0060 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Left"     => "0000 0067 0000 0015 0060 0018 0030 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Right"    => "0000 0067 0000 0015 0060 0018 0018 0018 0018 0018 0030 0018 0030 0018 0030 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Rewind"   => "0000 0067 003F 0000 0060 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 01FA 0060 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 01FA 0060 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
"Fforward" => "0000 0067 003F 0000 0060 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 01E2 0061 0017 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 01E2 0061 0017 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0030 0018 0018 0018 0030 0018 0030 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 0018 0018 0018 0030 0018 0018 03F6",
);

 echo "Pause decoded : <br>";
 DecodeCCF ( $aCcf['Pause'] ) ;
 echo "<br>";

echo "Pause = " . CCFtoGC( $aCcf['Pause'] ) . "<br>";


function DecodeCCF ( $a )
{
	$aExplode = explode( ' ', $a );
	$nCount = count( $aExplode );
	$sPairs1 = hexdec( $aExplode[2] );
	$sPairs2 = hexdec( $aExplode[3] );

	if( $aExplode[2] == '0000' )
	{
		echo "Sequence 2<br>";
		$html = ''; $n = $c = 0;
		$html = '';
		for( $i = 6; $i < ($sPairs2*2)+1; $i += 2 )
		{
			$c++;
			if( $aExplode[$i] === '0030' ) $html = "1".$html; else $html = "0".$html;
			if( $i == ($sPairs2*2)-24 ) { echo "Binary: " . $html ." - Command: " . bindec($html) . "<br>"; $html = ''; $n = 1; }
			if( $c == 7 && $n == 0 ) { echo "Binary: " . $html ." - Command: " . bindec($html) . "<br>"; $html = ''; $c = 0; }
		}
		echo "Binary: " . $html ." - Device ID: " . bindec($html) . "<br>";
	}
	elseif( $aExplode[3] == '0000' )
	{
		echo "Sequence 1<br>";
		$html = ''; $n = $c = 0;
		for( $i = 6; $i < ($sPairs1*2)+1; $i += 2 )
		{
			$c++;
			if( $aExplode[$i] === '0030' ) $html = "1".$html; else $html = "0".$html;
			if( $i == ($sPairs1*2)-24 ) { echo $html ." "; echo bindec($html)."<br>"; $html = ''; $n = 1; }
			if( $c == 7 && $n == 0 ) { echo "Binary:" . $html ." Command: " . bindec($html) . "<br>"; $html = ''; $c = 0; }
		}
		echo $html ." "; echo bindec($html)."<br>";
	}
	else
	{
		echo "Sequence 1<br>";
		$html = ''; $n = $c = 0;

		for( $i = 6; $i < ($sPairs1*2)+1; $i += 2 )
		{
			$c++;
			if( $aExplode[$i] === '0030' ) $html = "1".$html; else $html = "0".$html;
			//if( $i == ($sPairs1*2)-24 ) { echo $html ." "; echo bindec($html)."<br>"; $html = ''; $n = 1; }
			if( $c == 7 ) { echo "Binary:" . $html ." Command: " . bindec($html) . "<br>"; $html = ''; $c = 0; }
		}
		echo $html ." "; echo bindec($html)."<br>";
		echo "Sequence 2<br>";
		$html = ''; $n = $c = 0;
		$html = '';

		for( $i = 6 + ($sPairs1*2); $i < (($sPairs1*2)+($sPairs2*2)+1); $i += 2 )
		{
			$c++;
			if( $aExplode[$i] === '0030' ) $html = "1".$html; else $html = "0".$html;
			if( $i == ($sPairs1*2)+($sPairs2*2)-24 ) { echo $html ." "; echo bindec($html)."<br>"; $html = ''; $n = 1; }
			if( $c == 7 && $n == 0 ) { echo "Binary:" . $html ." Command: " . bindec($html) . "<br>"; $html = ''; $c = 0; }
		}
		echo $html ." "; echo bindec($html)."<br>";
	}
}

?>